<!DOCTYPE html>
<html>
<head>
  <title>Socket.io Chat Test</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <h2>Socket Chat Test</h2>
  <input type="text" id="userId" placeholder="Your User ID"><br>
  <input type="text" id="swapId" placeholder="Swap ID"><br>
  <input type="text" id="text" placeholder="Type your message"><br>
  <button onclick="send()">Send Message</button>
  <ul id="chat"></ul>

  <script>
    const socket = io("http://localhost:6969");

    document.getElementById("userId").addEventListener("change", function () {
      const userId = this.value;
      socket.emit("register", userId);
    });

    socket.on("newMessage", (msg) => {
      const item = document.createElement("li");
      item.textContent = `[NEW] ${msg.text}`;
      document.getElementById("chat").appendChild(item);
    });

    socket.on("messageSent", (msg) => {
      const item = document.createElement("li");
      item.textContent = `[YOU] ${msg.text}`;
      document.getElementById("chat").appendChild(item);
    });

    function send() {
      const userId = document.getElementById("userId").value;
      const swapId = document.getElementById("swapId").value;
      const text = document.getElementById("text").value;

      socket.emit("sendMessage", { senderId: userId, swapId, text });
    }
  </script>
</body>
</html>
